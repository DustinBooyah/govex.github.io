
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../common/delimited-favicon-v4.ico">
    <title>Sunburst Chart</title>
    <script type="text/javascript" src="d3-master/d3.js"></script>
    <script type="text/javascript" src="underscore-min.js"></script>
  </head>
  <body>
  <div id="viz"></div>
<script>
d3.csv("data.csv", function(error, data) {

  //*************************************************
  // FUNCTION
  //*************************************************
  function genJSON(csvData, groups) {

    var genGroups = function(data) {
      return _.map(data, function(element, index) {
        return { name : index, children : element };
      });
    };

    var nest = function(node, curIndex) {
      if (curIndex === 0) {
        node.children = genGroups(_.groupBy(csvData, groups[0]));
        _.each(node.children, function (child) {
          nest(child, curIndex + 1);
        });
      }
      else {
        if (curIndex < groups.length) {
          node.children = genGroups(
            _.groupBy(node.children, groups[curIndex])
          );
          _.each(node.children, function (child) {
            nest(child, curIndex + 1);
          });
        }
      }
      return node;
    };
    return nest({}, 0);
  }

  //*************************************************
  // CALL FUNCTION WITH ARRAY OF GROUPS
  //*************************************************


  var preppedData = genJSON(data, ['WWC Standard','Average Joe standard','GovEx Book','GovEx Chapter','GovEx Verse','Pre/Post Metric'])

  //*************************************************
  // YOUR DATA VISUALIZATION CODE HERE
  //*************************************************
</script>
<script>
  ! function() {
      function t(n, e) {
          return n === e ? !0 : n.children ? n.children.some(function(n) {
              return t(n, e)
          }) : !1
      }

      function n(t) {
          if (t.children) {
              var e = t.children.map(n),
                  r = d3.hsl(e[0]),
                  a = d3.hsl(e[1]);
              return d3.hsl((r.h + a.h) / 2, 1.2 * r.s, r.l / 1.2)
          }
          return t.colour || "#fff"
      }

      function e(t) {
          var n = r(t),
              e = d3.interpolate(d.domain(), [t.x, t.x + t.dx]),
              a = d3.interpolate(u.domain(), [t.y, n]),
              i = d3.interpolate(u.range(), [t.y ? 20 : 0, o]);
          return function(t) {
              return function(n) {
                  return d.domain(e(n)), u.domain(a(n)).range(i(n)), x(t)
              }
          }
      }

      function r(t) {
          return t.children ? Math.max.apply(Math, t.children.map(r)) : t.y + t.dy
      }

      function a(t) {
          return .299 * t.r + .587 * t.g + .114 * t.b
      }
      var i = 840,
          l = i,
          o = i / 2,
          d = d3.scale.linear().range([0, 2 * Math.PI]),
          u = d3.scale.pow().exponent(1.3).domain([0, 1]).range([0, o]),
          c = 5,
          s = 1e3,
          h = d3.select("#vis");
      h.select("img").remove();
      var f = h.append("svg").attr("width", i + 2 * c).attr("height", l + 2 * c).append("g").attr("transform", "translate(" + [o + c, o + c] + ")");
      h.append("p").attr("id", "intro").text("Click to zoom!");
      var p = d3.layout.partition().sort(null).value(function(t) {
              return 5.8 - t.depth
          }),
          x = d3.svg.arc().startAngle(function(t) {
              return Math.max(0, Math.min(2 * Math.PI, d(t.x)))
          }).endAngle(function(t) {
              return Math.max(0, Math.min(2 * Math.PI, d(t.x + t.dx)))
          }).innerRadius(function(t) {
              return Math.max(0, t.y ? u(t.y) : t.y)
          }).outerRadius(function(t) {
              return Math.max(0, u(t.y + t.dy))
          });
        };
</script>
</body>
</html>
